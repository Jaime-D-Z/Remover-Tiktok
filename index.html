<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TikTok Downloader - Sin Marca de Agua üé¨</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"
    rel="stylesheet"
  />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Fondo animado -->
  <div class="animated-bg">
    <div class="bubble"></div>
    <div class="bubble"></div>
    <div class="bubble"></div>
    <div class="bubble"></div>
    <div class="bubble"></div>
  </div>

  <!-- Navbar -->
  <nav class="navbar custom-navbar">
    <div class="container">
      <a class="navbar-brand" href="#">
        <i class="fab fa-tiktok"></i>
        TikTok Downloader
      </a>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" id="darkModeToggle" />
        <label class="form-check-label" for="darkModeToggle">
          <i class="fas fa-moon"></i>
        </label>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="container">
      <h1 class="hero-title">
        Descarga Videos de <span class="gradient-text">TikTok</span><br>
        Sin Marca de Agua üé¨
      </h1>
      <p class="hero-subtitle">
        R√°pido, f√°cil y 100% gratis. Pega el enlace y descarga en segundos.
      </p>

      <!-- Search Input -->
      <div class="search-container">
        <div class="input-group-custom">
          <input
            id="tiktokUrl"
            type="text"
            placeholder="üîó Pega aqu√≠ tu enlace de TikTok..."
            aria-label="Enlace de TikTok"
          />
          <button id="downloadBtn">
            <i class="fas fa-download me-2"></i>
            Descargar
          </button>
        </div>
      </div>

      <!-- Result -->
      <div id="result" style="display: none;"></div>
    </div>
  </section>

  <!-- Features Section -->
  <section class="features-section">
    <div class="container">
      <div class="row g-4">
        <div class="col-md-4">
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-bolt"></i>
            </div>
            <h3 class="feature-title">Super R√°pido</h3>
            <p class="feature-text">Descarga tus videos favoritos en segundos sin complicaciones</p>
          </div>
        </div>
        <div class="col-md-4">
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-shield-alt"></i>
            </div>
            <h3 class="feature-title">100% Seguro</h3>
            <p class="feature-text">Sin virus, sin anuncios molestos, completamente seguro</p>
          </div>
        </div>
        <div class="col-md-4">
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-hd-video"></i>
            </div>
            <h3 class="feature-title">Alta Calidad</h3>
            <p class="feature-text">Videos sin marca de agua en la mejor calidad disponible</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- How to Use Section -->
  <section class="steps-section">
    <div class="container">
      <h2 class="text-center mb-5">
        <span class="gradient-text">¬øC√≥mo usar?</span>
      </h2>
      <div class="row justify-content-center">
        <div class="col-lg-8">
          <div class="step-card">
            <div class="step-number">1</div>
            <div>
              <h4 class="mb-1">Abre TikTok</h4>
              <p class="mb-0 feature-text">Encuentra el video que quieres descargar en tu app de TikTok</p>
            </div>
          </div>
          <div class="step-card">
            <div class="step-number">2</div>
            <div>
              <h4 class="mb-1">Copia el enlace</h4>
              <p class="mb-0 feature-text">Toca "Compartir" ‚Üí "Copiar enlace" en el video</p>
            </div>
          </div>
          <div class="step-card">
            <div class="step-number">3</div>
            <div>
              <h4 class="mb-1">Pega y descarga</h4>
              <p class="mb-0 feature-text">Pega el enlace aqu√≠ arriba y presiona el bot√≥n de descargar</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container text-center">
      <div class="social-links mb-3">
        <a href="https://github.com/Jaime-D-Z/Remover-Tiktok" target="_blank" rel="noopener">
          <i class="fab fa-github"></i>
        </a>
        <a href="#" target="_blank" rel="noopener">
          <i class="fab fa-twitter"></i>
        </a>
        <a href="#" target="_blank" rel="noopener">
          <i class="fab fa-instagram"></i>
        </a>
      </div>
      <p class="mb-0 text-muted small">
        &copy; 2025 TikTok Downloader. Hecho con ‚ù§Ô∏è por 
        <a href="https://github.com/Jaime-D-Z" target="_blank" style="color: #fe2c55; text-decoration: none;">
          @Jaime-D-Z
        </a>
      </p>
      <p class="mb-0 text-muted small mt-2">
        <i class="fas fa-code"></i> C√≥digo abierto en 
        <a href="https://github.com/Jaime-D-Z/Remover-Tiktok" target="_blank" style="color: #fe2c55; text-decoration: none;">
          GitHub
        </a>
      </p>
    </div>
  </footer>

  <script>
const btn = document.getElementById("downloadBtn");
const result = document.getElementById("result");
const urlInput = document.getElementById("tiktokUrl");
const darkModeToggle = document.getElementById("darkModeToggle");
const body = document.body;

// Dark Mode
let darkModeEnabled = false;

darkModeToggle.addEventListener("change", () => {
  if (darkModeToggle.checked) {
    body.classList.add("dark-mode");
    darkModeEnabled = true;
  } else {
    body.classList.remove("dark-mode");
    darkModeEnabled = false;
  }
});

// Mostrar mensajes
function displayMessage(type, message, isError = false) {
  const color = isError ? 'text-danger' : (type === 'info' ? 'text-info' : 'text-success');
  const icon = isError ? '‚ùå' : (type === 'info' ? '‚è≥' : '‚úÖ');
  result.style.display = 'block';
  result.innerHTML = `<p class="${color} fw-bold mb-0">${icon} ${message}</p>`;
}

// L√≥gica principal
btn.addEventListener("click", async () => {
  const url = urlInput.value.trim();
  
  if (!url) {
    displayMessage('warning', 'Por favor, pega un enlace de TikTok v√°lido', true);
    return;
  }
  
  btn.disabled = true;
  btn.innerHTML = '<span class="spinner-border me-2"></span> Procesando...';
  displayMessage('info', 'Analizando el video...', false);

  try {
    const resolveResp = await fetch("/.netlify/functions/resolve", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ url }),
    });

    if (resolveResp.status === 404) {
      throw new Error("Servicio no disponible. Por favor, intenta m√°s tarde.");
    }

    const resolveData = await resolveResp.json();
    if (!resolveResp.ok) {
      throw new Error(resolveData.error || `Error: HTTP ${resolveResp.status}`);
    }

    const { videoId } = resolveData;
    displayMessage('success', 'Video encontrado! Preparando descarga...', false);

    const downloadProxyUrl = `/.netlify/functions/download?videoId=${videoId}`;

    if (videoId) {
      result.innerHTML = `
        <div class="text-center">
          <p class="text-success fw-bold mb-3">‚úÖ ¬°Listo para descargar!</p>
          <a 
            href="${downloadProxyUrl}" 
            class="download-btn" 
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fas fa-download"></i>
            Descargar Video
          </a>
          <p class="text-muted small mt-3 mb-0">
            <i class="fas fa-info-circle me-1"></i> 
            Se abrir√° en una nueva pesta√±a
          </p>
        </div>
      `;
    } else {
      displayMessage('error', "No se pudo procesar el video", true);
    }
  } catch (error) {
    console.error("Error:", error);
    displayMessage('error', `Error: ${error.message}`, true);
  } finally {
    btn.disabled = false;
    btn.innerHTML = '<i class="fas fa-download me-2"></i> Descargar';
  }
});

// Enter key support
urlInput.addEventListener("keypress", (e) => {
  if (e.key === "Enter") {
    btn.click();
  }
});
  </script>
</body>
</html>
